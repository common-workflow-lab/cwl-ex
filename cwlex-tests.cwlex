import "cwlex.cwlex" as cwlex

def workflow main(
 cases = [
   [File("tests/antlr/antlr.cwlex"), File("tests/antlr/antlr.cwl")],
   [File("tests/const/const_values.cwlex"), File("tests/const/const_values.cwl")],
   [File("tests/quote/quote.cwlex"), File("tests/quote/quote.cwl")],
   [File("tests/req/req.cwlex"), File("tests/req/req.cwl")],
   [File("tests/site/cwlsite.cwlex"), File("tests/site/cwlsite.cwl")],
   [File("tests/linkmerge/linkmerge.cwlex"), File("tests/linkmerge/linkmerge.cwl")],
   [File("tests/example/ex1.cwlex"), File("tests/example/ex1.cwl")]
   [File("tests/example/ex2.cwlex"), File("tests/example/ex2.cwl")],
   [File("tests/example/ex3.cwlex"), File("tests/example/ex3.cwl")],
   [File("tests/example/ex4.cwlex"), File("tests/example/ex4.cwl")],
   [File("tests/example/ex5.cwlex"), File("tests/example/ex5.cwl")],
   [File("tests/example/ex6.cwlex"), File("tests/example/ex6.cwl")],
   [File("tests/example/ex7.cwlex"), File("tests/example/ex7.cwl")],
   [File("tests/example/ex8.cwlex"), File("tests/example/ex8.cwl")],
   [File("tests/example/ex9.cwlex"), File("tests/example/ex9.cwl")],
   [File("tests/example/ex10.cwlex"), File("tests/example/ex10.cwl")],
   [File("tests/example/ex11.cwlex"), File("tests/example/ex11.cwl")],
   [File("tests/example/ex12.cwlex"), File("tests/example/ex12.cwl")],
   [File("tests/example/ex13.cwlex"), File("tests/example/ex13.cwl")],
   [File("tests/example/ex14.cwlex"), File("tests/example/ex14.cwl")]
 ]
) {
  scatter cases do run workflow() {
    cwlex(cases, inp=$(inputs.cases[0]))
    run tool(cases, converted) {
      diff -u $(inputs.converted) $(inputs.cases[1]) > $(inputs.cases[1].basename+".diff")
      return File(inputs.cases[1].basename+".diff") as results
    }
    return results
  }
}